@{
    ViewBag.Title = "Login";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Login</h2>

<div id="login-form">
    <div class="form-group">
        <label for="username">Username:</label>
        <input type="text" id="username" class="form-control" />
    </div>

    <div class="form-group">
        <label for="password">Password:</label>
        <input type="password" id="password" class="form-control" />
    </div>

    <div class="form-group">
        <button type="button" id="login-button" class="btn btn-primary">Login</button>
    </div>
</div>

<div id="login-loading" style="display: none;">
    <p>Loading...</p>
</div>

<div id="login-error" class="alert alert-danger" style="display: none;"></div>

@section scripts {
    <script>
        $(function () {
            $('#login-button').click(function () {
                var username = $('#username').val();
                var password = $('#password').val();

                var data = {
                    username: username,
                    password: password
                };

                $('#login-form').hide();
                $('#login-loading').show();
                $('#login-error').hide().empty();

                $.ajax({
                    type: 'POST',
                    url: 'http://localhost:5096/api/login',
                    data: JSON.stringify(data),
                    contentType: 'application/json',
                    success: function () {
                        window.location.href = '/home'; // Redirect to home page after successful login
                    },
                    error: function (xhr) {
                        $('#login-form').show();
                        $('#login-loading').hide();
                        $('#login-error').text(xhr.responseText).show();
                    }
                });
            });
        });
    </script>
}